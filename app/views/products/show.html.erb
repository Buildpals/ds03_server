<style>
  .container {
    max-width: 70rem;
  }
</style>

<div class="container">

  <div class="row mt-3">

    <div class="col-lg-4">
      <div class="card mb-3">

        <img src="<%= @product.main_image %>" class="card-img-top p-2 img-fluid" alt="...">

        <div class="card-body">
          <h6 class="card-title">
            <%= @product.title %>
          </h6>

          <%= form_with(model: @product, local: false) do |form| %>
            <div class="form-group">
              <%= form.label :chosen_offer_id, "Price Offers" %>
              <%= form.collection_radio_buttons :chosen_offer_id,
                                                @product.offers,
                                                value_method = :last,
                                                text_method = :first do |b| %>
                <div class="form-check">
                  <%= b.radio_button class: "form-check-input", onclick: 'this.form.submit();' %>
                  <%= b.label class: "form-check-label", onclick: 'this.form.submit();' %>
                </div>
              <% end %>
            </div>
          <% end %>

          <div class="w-100 d-flex justify-content-between">
            <a href="<%= @product.item_url %>" target="_blank">View in Amazon</a>
          </div>

          <% if current_user&.admin? %>
            <br>

            <%= link_to 'Delete Product', @product, method: :delete, data: {confirm: 'Are you sure?'}, class: 'btn btn-block btn-danger' %>
          <% end %>

        </div>

      </div>
    </div>

    <div class="col-lg-4">
      <div class="card mb-3">
        <div class="card-body">
          <h6 class="card-title">
            Product Dimensions
          </h6>

          <div class="row mb-2">
            <div class="col-4">Width:</div>
            <div class="col-8 text-right">
              <%= number_with_precision @product.width, precision: 2 %>  <%= @product.width_unit %>
            </div>

            <div class="col-4">Length:</div>
            <div class="col-8 text-right"><%= number_with_precision @product.length, precision: 2 %> <%= @product.length_unit %></div>

            <div class="col-4">Depth:</div>
            <div class="col-8 text-right"><%= number_with_precision @product.depth, precision: 2 %>  <%= @product.depth_unit %></div>

            <div class="col-4">Volume:</div>
            <div class="col-8 text-right"><%= number_with_precision @product.volume, precision: 2 %> inches&sup3;</div>
          </div>

          <div class="row">
            <div class="col-4">Weight:</div>
            <div class="col-8 text-right"><%= number_with_precision @product.weight, precision: 2 %> <%= @product.weight_unit %></div>
            <div class="col-7">
              Weight in pounds:
            </div>
            <div class="col-5 text-right">
              <%= number_with_precision @product.item_weight_in_pounds, precision: 2 %> pounds
            </div>
          </div>
        </div>
      </div>

      <div class="w-100 d-flex justify-content-between">
        <a href="/">Find another product</a>
      </div>
    </div>

    <div class="col-lg-4">

      <div class="card mb-3">
        <div class="card-body">
          <h6 class="card-title">
            Delivery Costs
          </h6>

          <dl class="row mt-4">
            <dt class="col-8">By Air (10-14 days)</dt>
            <dd class="col-4 text-right">
              <%= number_to_currency @product.shipping_and_handling_by_air(@product.default_price, 1) %>
            </dd>

            <dt class="col-8">By Sea (6-8 weeks)</dt>
            <dd class="col-4 text-right">
              <%= number_to_currency @product.shipping_and_handling_by_sea(@product.default_price, 1) %>
            </dd>
          </dl>
          <div class="small text-center">
            Duty charges may apply
          </div>

          <br>

          <% if current_user %>
            <%= form_with(model: [@product, @product.orders.build], local: true) do |form| %>
              <%= form.hidden_field :chosen_offer_id, value: @product.chosen_offer_id %>
              <%= form.submit 'Purchase through ProcureSwift', class: 'btn btn-block btn-accent', id: 'checkout_button' %>
            <% end %>
          <% else %>
              <%= link_to 'Purchase through ProcureSwift',
                          new_user_session_path,
                          class: 'btn btn-block btn-accent',
                          id: 'checkout_button',
              notice: 'You need to login before you can purchase'%>
          <% end %>


        </div>
      </div>

    </div>

  </div>

</div>

<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://api.ravepay.co/flwv3-pug/getpaidx/api/flwpbf-inline.js"></script>